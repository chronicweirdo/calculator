<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <script>
            function myEv(){
                console.log("evaluating")
                let expression = document.getElementById("ecuation").value
                let result = Function('"use strict";return (' + expression + ')')()
                console.log(result)
                document.getElementById("result").innerHTML = result
                //return result
            }
            function insertIn(ch) {
                let eq = document.getElementById("ecuation")
                let currentVal = eq.value
                let start = eq.selectionStart
                let end = eq.selectionEnd
                eq.value = currentVal.slice(0, start) + ch + currentVal.slice(end)
                eq.focus()
                eq.selectionStart = start+1
                eq.selectionEnd = start+1
            }
            function del() {
                let eq = document.getElementById("ecuation")
                let currentVal = eq.value
                let start = eq.selectionStart
                let end = eq.selectionEnd
                if (start == end && start > 0) {
                    eq.value = currentVal.slice(0, start-1) + currentVal.slice(end)
                    eq.selectionStart = start-1
                    eq.selectionEnd = start-1
                } else {
                    eq.value = currentVal.slice(0, start) + currentVal.slice(end)
                    eq.selectionStart = start
                    eq.selectionEnd = start
                }
                eq.focus()
            }
        </script>
    </head>
    <body>
        <textarea id="ecuation" name="ecuation" rows="4" cols="50" inputmode="none"></textarea>
        <button type="button" onclick="myEv()">Calculate</button>
        <div id="result"></div>
        <div id="controls">
            <button type="button" onclick="insertIn('0')">0</button>
            <button type="button" onclick="insertIn('1')">1</button>
            <button type="button" onclick="insertIn('2')">2</button>
            <button type="button" onclick="insertIn('3')">3</button>
            <button type="button" onclick="insertIn('4')">4</button>
            <button type="button" onclick="insertIn('5')">5</button>
            <button type="button" onclick="insertIn('6')">6</button>
            <button type="button" onclick="insertIn('.')">.</button>
            <button type="button" onclick="insertIn('+')">+</button>
            <button type="button" onclick="insertIn('-')">-</button>
            <button type="button" onclick="insertIn('*')">*</button>
            <button type="button" onclick="insertIn('/')">/</button>
            <button type="button" onclick="insertIn('(')">(</button>
            <button type="button" onclick="insertIn(')')">)</button>
            <button type="button" onclick="del()">bs</button>
        </div>
    </body>
</html>